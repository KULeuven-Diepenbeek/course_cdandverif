<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.68.3" />
    <meta name="description" content="">


    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>201 Register file :: Chip Design and Verification</title>

    
    <link href="../../css/nucleus.css?1692348126" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1692348126" rel="stylesheet">
    <link href="../../css/hybrid.css?1692348126" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1692348126" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1692348126" rel="stylesheet">
    <link href="../../css/auto-complete.css?1692348126" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1692348126" rel="stylesheet">
    <link href="../../css/theme.css?1692348126" rel="stylesheet">
    <link href="../../css/tabs.css?1692348126" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1692348126" rel="stylesheet">
    
    <link href="../../css/theme-kul.css?1692348126" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1692348126"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
        :not(pre) > code + span.copy-to-clipboard {
            display: none;
        }
      
    </style>
    
<script src=../../js/exercises.js></script> 
  </head>
  <body class="" data-url="/200_increase/201_registerfile/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="https://www.kuleuven.be/kuleuven/" target="_blank">
  <img src="../../img/style/kul.png" alt="KU Leuven" /><br/>
</a>
<a href="https://www.uhasselt.be/" target="_blank">
  <img src="../../img/style/uhasselt.svg" alt="UHasselt" id="uhlogo" />
</a>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1692348126"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1692348126"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/kuleuven-diepenbeek.github.io\/course_cdandverif\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1692348126"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/000_intro/" title="0 Introduction" class="dd-item
        
        
        
        ">
      <a href="../../000_intro/">
          0 Introduction
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/000_intro/000_introduction/" title="000 Introduction" class="dd-item ">
        <a href="../../000_intro/000_introduction/">
        000 Introduction
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/000_intro/001_organisation/" title="001 Organisation" class="dd-item ">
        <a href="../../000_intro/001_organisation/">
        001 Organisation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/000_intro/002_lab/" title="002 Lab" class="dd-item ">
        <a href="../../000_intro/002_lab/">
        002 Lab
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/100_wetfeet/" title="1 Getting your feet wet" class="dd-item
        
        
        
        ">
      <a href="../../100_wetfeet/">
          1 Getting your feet wet
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/100_wetfeet/100_alu/" title="100 ALU" class="dd-item ">
        <a href="../../100_wetfeet/100_alu/">
        100 ALU
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_wetfeet/101_testing/" title="101 Testing" class="dd-item ">
        <a href="../../100_wetfeet/101_testing/">
        101 Testing
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_wetfeet/102_systemverilog/" title="102 SystemVerilog" class="dd-item ">
        <a href="../../100_wetfeet/102_systemverilog/">
        102 SystemVerilog
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_wetfeet/103_interfaces/" title="103 Interfaces" class="dd-item ">
        <a href="../../100_wetfeet/103_interfaces/">
        103 Interfaces
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_wetfeet/104_helloworld/" title="104 Hello world" class="dd-item ">
        <a href="../../100_wetfeet/104_helloworld/">
        104 Hello world
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/100_wetfeet/105_assignment/" title="105 Assignment 1" class="dd-item ">
        <a href="../../100_wetfeet/105_assignment/">
        105 Assignment 1
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/200_increase/" title="2 Adding some registers" class="dd-item
        parent
        
        
        ">
      <a href="../../200_increase/">
          2 Adding some registers
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/200_increase/201_registerfile/" title="201 Register file" class="dd-item active">
        <a href="../../200_increase/201_registerfile/">
        201 Register file
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/200_increase/202_test/" title="202 Updating test" class="dd-item ">
        <a href="../../200_increase/202_test/">
        202 Updating test
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/200_increase/203_practice/" title="203 Practice" class="dd-item ">
        <a href="../../200_increase/203_practice/">
        203 Practice
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/300_oo/" title="3 Climbing the OO ladder" class="dd-item
        
        
        
        ">
      <a href="../../300_oo/">
          3 Climbing the OO ladder
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/300_oo/301_layered_testbench/" title="301 Layered testbench" class="dd-item ">
        <a href="../../300_oo/301_layered_testbench/">
        301 Layered testbench
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/302_monitor/" title="302 Adding a monitor" class="dd-item ">
        <a href="../../300_oo/302_monitor/">
        302 Adding a monitor
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/303_joinorfail/" title="303 Join or fail" class="dd-item ">
        <a href="../../300_oo/303_joinorfail/">
        303 Join or fail
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/304_transactions/" title="304 Transactions" class="dd-item ">
        <a href="../../300_oo/304_transactions/">
        304 Transactions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/305_mailboxes/" title="305 Mailboxes" class="dd-item ">
        <a href="../../300_oo/305_mailboxes/">
        305 Mailboxes
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/306_assignment/" title="306 Assignment 2" class="dd-item ">
        <a href="../../300_oo/306_assignment/">
        306 Assignment 2
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/307_scoreboard/" title="307 Checker &amp; scoreboard" class="dd-item ">
        <a href="../../300_oo/307_scoreboard/">
        307 Checker &amp; scoreboard
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/300_oo/308_golden/" title="308 Golden reference" class="dd-item ">
        <a href="../../300_oo/308_golden/">
        308 Golden reference
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/400_rand/" title="4 Randomisation" class="dd-item
        
        
        
        ">
      <a href="../../400_rand/">
          4 Randomisation
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/400_rand/401_randomisation/" title="401 Randomisation" class="dd-item ">
        <a href="../../400_rand/401_randomisation/">
        401 Randomisation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/400_rand/402_constraint/" title="402 Constraints" class="dd-item ">
        <a href="../../400_rand/402_constraint/">
        402 Constraints
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/400_rand/403_dpandcp/" title="403 DP and CP" class="dd-item ">
        <a href="../../400_rand/403_dpandcp/">
        403 DP and CP
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/400_rand/404_assignment/" title="404 Assignment 3" class="dd-item ">
        <a href="../../400_rand/404_assignment/">
        404 Assignment 3
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/500_coverage/" title="5 Coverage" class="dd-item
        
        
        
        ">
      <a href="../../500_coverage/">
          5 Coverage
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/500_coverage/501_coverage/" title="501 Coverage" class="dd-item ">
        <a href="../../500_coverage/501_coverage/">
        501 Coverage
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/500_coverage/502_funccoverage/" title="502 Functional coverage" class="dd-item ">
        <a href="../../500_coverage/502_funccoverage/">
        502 Functional coverage
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/500_coverage/503_crosscoverage/" title="503 Cross coverage" class="dd-item ">
        <a href="../../500_coverage/503_crosscoverage/">
        503 Cross coverage
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/500_coverage/504_morebins/" title="504 More on bins" class="dd-item ">
        <a href="../../500_coverage/504_morebins/">
        504 More on bins
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/500_coverage/505_assignment/" title="505 Assignment 4" class="dd-item ">
        <a href="../../500_coverage/505_assignment/">
        505 Assignment 4
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/600_assertions/" title="6 Assertions" class="dd-item
        
        
        
        ">
      <a href="../../600_assertions/">
          6 Assertions
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/600_assertions/601_assertions/" title="601 Assertions" class="dd-item ">
        <a href="../../600_assertions/601_assertions/">
        601 Assertions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/600_assertions/602_sequences/" title="602 Sequences" class="dd-item ">
        <a href="../../600_assertions/602_sequences/">
        602 Sequences
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/600_assertions/603_implications/" title="603 Implications" class="dd-item ">
        <a href="../../600_assertions/603_implications/">
        603 Implications
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/700_project/" title="7 Project" class="dd-item
        
        
        
        ">
      <a href="../../700_project/">
          7 Project
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/800_finalremarks/" title="8 Final remarks" class="dd-item
        
        
        
        ">
      <a href="../../800_finalremarks/">
          8 Final remarks
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/800_finalremarks/801_final/" title="801 Final remarks" class="dd-item ">
        <a href="../../800_finalremarks/801_final/">
        801 Final remarks
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/appendices/" title="Appendices" class="dd-item
        
        
        
        ">
      <a href="../../appendices/">
          Appendices
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/appendices/cheat/" title="QuestaSim Commanline Cheats" class="dd-item ">
        <a href="../../appendices/cheat/">
        QuestaSim Commanline Cheats
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://studiegidswww.uhasselt.be/opleidingsonderdeel.aspx?a=2023&amp;i=3467&amp;n=4&amp;t=04#anker46108"><i class='fa fa-university'></i> ECTS Sheet</a>
              </li>
          
              <li>
                  <a class="padding" href="https://toledo.kuleuven.be/"><i class='fa fa-university'></i> Toledo</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>Chip Design and Verification</a> > <a href='../../200_increase/'>2 Adding some registers</a> > 201 Register file
          
        
          
        
          
        
                 
                  </span>
                </div>
                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
          <div id="chapter">
        
        <div id="body-inner">
          

        




<h1 id="register-file">Register file</h1>

<p>With our first experiments done, it is time to add some registers. Typically a processor has an array of registers inside to be used during operation: <strong>the register file</strong>. The GameBoy CPU has eight 8-bit registers and two 16-bit registers. The 8-bit registers are labeled: <strong>A</strong>, <strong>B</strong>, <strong>C</strong>, <strong>D</strong>, <strong>E</strong>, <strong>F</strong>, <strong>H</strong>, and <strong>L</strong>. The 16-bit registers are the <strong>program counter (PC)</strong> and the <strong>stack pointer (SP)</strong>. We&rsquo;re not going to bother with the memory in which the programs reside, so we can forget about the latter two. With this comes that the 16-bit operations also fall out-of-scope with respect to verification in this course.</p>

<p>Two 8-bit registers deserve some additional explanation: <strong>register A</strong>, and <strong>register F</strong>.</p>

<div class="multiHcolumn">
  
<div class="column">
  <h3 id="register-f">Register F</h3>

<p>This register is used to store the 4 flags: <strong>Z</strong>, <strong>N</strong>, <strong>H</strong>, and <strong>C</strong>. They are positioned on the left-hand side, so the 4 least significant bits are always set to 0. We discussed these flag in the beginning of these lab sessions <a href="../../100_wetfeet/100_alu/">ALU</a>.</p>

<h3 id="register-a">Register A</h3>

<p>Register A works a sort of accumulator register. The instructions for the ALU always use the A register as an operand, and the result of the ALU-operation is stored back in register A.</p>

<h3 id="other-registers">Other registers</h3>

<p>Off course the other registers are equally important. These registers can also be <strong>LOADED</strong> through machine-code instructions like <em>LD B, L</em> (e.g. load the value of register L into register B). As we want to stay focused on the ALU operations, the load instructions are left out of scope. This, however, would turn the other registers rather pointless, as we can not load any values in them. Therefore they are preloaded with fixed values. Please mind, this is not a correct model of the actual processor, but it will keep things a little more simple.</p>

</div>    

<div class="column">
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-systemverilog" data-lang="systemverilog">    ...

    <span style="color:#75715e">/* REGISTERS */</span>
    <span style="color:#66d9ef">always_ff</span> @(<span style="color:#66d9ef">posedge</span> clock)
    <span style="color:#66d9ef">begin</span>
        <span style="color:#66d9ef">if</span> (reset)
        <span style="color:#66d9ef">begin</span>
            regA <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h0</span>;
            regB <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h1</span>;
            regC <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h2</span>;
            regD <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h3</span>;
            regE <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h4</span>;
            regF <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h0</span>;
            regH <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h5</span>;
            regL <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h6</span>;
        <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">begin</span>
            <span style="color:#66d9ef">if</span> (load_regA <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b1</span>)
                regA <span style="color:#f92672">=</span> alu_Z;
            <span style="color:#66d9ef">if</span> (load_regF <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b1</span>)
                regF <span style="color:#f92672">=</span> { alu_flags_out, <span style="color:#ae81ff">4&#39;h0</span> };
        <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>

    ...
</code></pre></div>

<p></div></p>

<p></div></p>

<h2 id="bringing-the-dut-together">Bringing the DUT together</h2>

<p>The DUT, in the previous chapter, only existed out of the ALU. Now it will  also have the register file. With both components together, the DUT is ready for testing.</p>

<p>Since there is sequential logic in the <em>new</em> DUT, there is a need to add a <strong>clock</strong> and a <strong>reset</strong> signal. To indicate which operation the DUT has to execute, an <strong>8-bit instruction</strong> is also added together with a <strong>valid</strong> signal. It should be clear that an instruction is only to be execute when the valid signal is high.</p>

<p>With this arrangement it will be easy to give instructions to the DUT. However, as these labs focus on verification there should also be a way to see what the DUT generated. For this purpose (and given the simplicity of the DUT) a probe can done on registers A and F.</p>

<p><img src="../../img/probe.png" alt="Probing the DUT" /></p>

<h2 id="a-word-on-the-operation">A word on the operation</h2>

<p>The machine-level instructions in the GameBoy are <strong>8 bits</strong> in width. Until now, only 3 bits were used to indicate an instruction for the ALU. Another 3 bits are required to make a selection on the second operand. This totals to 6 bits. So &hellip; we&rsquo;re missing 2 bits. Luckily for us, (almost) all the operations that involve the ALU start with &ldquo;10&rdquo;. This can be seen nicely on (<a href="https://www.pastraiser.com/cpu/gameboy/gameboy_opcodes.html" target="_blank">this webpage</a>).</p>

<p><img src="../../img/instruction.png" alt="Instructions" /></p>

<p>As an example the operation <code>ADC H</code> is used. This operation takes whatever is present in <strong>register A</strong> and adds <strong>register H</strong>. The sum is then stored again in <strong>register A</strong>. The possible carry-flag from the previous operation is also added in the sum.</p>

<p>As this operation is an ALU instruction it starts with <strong>&ldquo;10&rdquo;</strong>. The operation <strong>ADC</strong> is represented with <strong>&ldquo;001&rdquo;</strong>. Finally, the selection of the second operand <strong>H</strong> comes down to appending <strong>&ldquo;100&rdquo;</strong>. This results in the binary code: <strong>10001100</strong>.</p>


<div class="notices info" ><p>On the operand selection there is an option to choose <strong>(HL)</strong>. This notation indicates there is <strong>indirect addressing</strong>. The value of this operand is the <strong>content</strong> which is stored at the address that is formed by concatenating the values of <strong>H</strong> and <strong>L</strong>.
<br/>
<br/>
In this lab setup, this value is ignored as the memory is out of scope for these labs.</p>
</div>


<h2 id="the-resulting-dut">The resulting DUT</h2>

<p>The DUT as shown above, can be described as follows.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-systemverilog" data-lang="systemverilog"><span style="color:#75715e">//------------------------------------------------------------------------------
</span><span style="color:#75715e">// KU Leuven - ESAT/COSIC- Embedded Systems &amp; Security
</span><span style="color:#75715e">//------------------------------------------------------------------------------
</span><span style="color:#75715e">// Module Name:     gbprocessor - Behavioral
</span><span style="color:#75715e">// Project Name:    CD and Verif
</span><span style="color:#75715e">// Description:     The processor, containing the ALU and registers
</span><span style="color:#75715e">//
</span><span style="color:#75715e">// Revision     Date       Author     Comments
</span><span style="color:#75715e">// v0.1         20211322   VlJo       Initial version
</span><span style="color:#75715e">//
</span><span style="color:#75715e">//------------------------------------------------------------------------------
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">module</span> gbprocessor (
    <span style="color:#66d9ef">input</span> reset,
    <span style="color:#66d9ef">input</span> clock,
    <span style="color:#66d9ef">input</span> [<span style="color:#ae81ff">7</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] instruction,
    <span style="color:#66d9ef">input</span> valid,
    <span style="color:#66d9ef">output</span> [<span style="color:#ae81ff">2</span><span style="color:#f92672">*</span><span style="color:#ae81ff">8</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] probe
);

    <span style="color:#66d9ef">logic</span> [<span style="color:#ae81ff">7</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] regA, regB, regC, regD, regE, regF, regH, regL;
    <span style="color:#66d9ef">logic</span> load_regA, load_regF;

    <span style="color:#66d9ef">logic</span> [<span style="color:#ae81ff">7</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] alu_B, alu_Z;
    <span style="color:#66d9ef">logic</span> [<span style="color:#ae81ff">3</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>] alu_flags_out;


    <span style="color:#66d9ef">assign</span> load_regA <span style="color:#f92672">=</span> instruction[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span>instruction[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">&amp;</span> valid;
    <span style="color:#66d9ef">assign</span> load_regF <span style="color:#f92672">=</span> instruction[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">&amp;</span> <span style="color:#f92672">~</span>instruction[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">&amp;</span> valid;
    <span style="color:#66d9ef">assign</span> probe <span style="color:#f92672">=</span> {regA, regF};

    <span style="color:#75715e">/* second operand selector MUX */</span>
    <span style="color:#66d9ef">always_comb</span>
    <span style="color:#66d9ef">begin</span>
        <span style="color:#66d9ef">case</span>(instruction[<span style="color:#ae81ff">2</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>])
            <span style="color:#ae81ff">3&#39;h0</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regB;
            <span style="color:#ae81ff">3&#39;h1</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regC;
            <span style="color:#ae81ff">3&#39;h2</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regD;
            <span style="color:#ae81ff">3&#39;h3</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regE;
            <span style="color:#ae81ff">3&#39;h4</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regH;
            <span style="color:#ae81ff">3&#39;h5</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regL;
            <span style="color:#ae81ff">3&#39;h6</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">8&#39;h0</span>;
            <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> alu_B <span style="color:#f92672">&lt;=</span> regA;
        <span style="color:#66d9ef">endcase</span>
    <span style="color:#66d9ef">end</span>

    <span style="color:#75715e">/* ALU */</span>
    ALU ALU_inst00(
        .A(regA),
        .B(alu_B),
        .flags_in(regF[<span style="color:#ae81ff">7</span><span style="color:#f92672">:</span><span style="color:#ae81ff">4</span>]),
        .operation(instruction[<span style="color:#ae81ff">5</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3</span>]),
        .Z(alu_Z),
        .flags_out(alu_flags_out));

    <span style="color:#75715e">/* REGISTERS */</span>
    <span style="color:#66d9ef">always_ff</span> @(<span style="color:#66d9ef">posedge</span> clock)
    <span style="color:#66d9ef">begin</span>
        <span style="color:#66d9ef">if</span> (reset)
        <span style="color:#66d9ef">begin</span>
            regA <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h0</span>;
            regB <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h1</span>;
            regC <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h2</span>;
            regD <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h3</span>;
            regE <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h4</span>;
            regF <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h0</span>;
            regH <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h5</span>;
            regL <span style="color:#f92672">=</span> <span style="color:#ae81ff">8&#39;h6</span>;
        <span style="color:#66d9ef">end</span> <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">begin</span>
            <span style="color:#66d9ef">if</span> (load_regA <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b1</span>)
                regA <span style="color:#f92672">=</span> alu_Z;
            <span style="color:#66d9ef">if</span> (load_regF <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span><span style="color:#ae81ff">&#39;b1</span>)
                regF <span style="color:#f92672">=</span> { alu_flags_out, <span style="color:#ae81ff">4&#39;h0</span> };
        <span style="color:#66d9ef">end</span>
    <span style="color:#66d9ef">end</span>

<span style="color:#66d9ef">endmodule</span>
</code></pre></div>


<footer class="footline">
	
</footer>

        
            </div> 
        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="../../200_increase/" title="2 Adding some registers"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../200_increase/202_test/" title="202 Updating test" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1692348126"></script>
    <script src="../../js/perfect-scrollbar.min.js?1692348126"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1692348126"></script>
    <script src="../../js/jquery.sticky.js?1692348126"></script>
    <script src="../../js/featherlight.min.js?1692348126"></script>
    <script src="../../js/highlight.pack.js?1692348126"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1692348126"></script>
    <script src="../../js/learn.js?1692348126"></script>
    <script src="../../js/hugo-learn.js?1692348126"></script>
    
        
            <script src="../../mermaid/mermaid.js?1692348126"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

